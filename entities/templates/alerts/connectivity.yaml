---
trigger:
  - platform: homeassistant
    event: start

  - platform: event
    event_type: event_template_reloaded

  - platform: state
    entity_id: sensor.time
binary_sensor:
  # {%- set ns = namespace(non_existing_sensors="", orphaned_sensors="") -%}

  # {# Handle missing sensors #}
  # {%- for attr in states.sensor.start_time.attributes | sort %}
  #   {%- set sensor_name = 'binary_sensor.ha_connected_integration_' + attr %}

  #   {%- if sensor_name not in states | map(attribute='entity_id') | list %}
  #       {%- if integration_entities(attr) | list | count > 0 %}
  #         # Create sensor
  #         - name: "[HA Connected Integration] {{attr}}"
  #           unique_id: ha_connected_integration_{{attr}}
  #           icon: "{% raw %}{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}{% endraw %}"
  #           picture: https://brands.home-assistant.io/{{attr}}/icon.png
  #           device_class: connectivity
  #           state: "{% raw %}{{ integration_entities('{% endraw %}{{attr}}{% raw %}')|select('has_value')|list|count > 0 }}{% endraw %}"
  #           attributes:
  #             category: homeassistant_connectivity
  #             entity_count: >
  #               "{% raw %}{{ integration_entities('{% endraw %}{{attr}}{% raw %}')|list|count }}{% endraw %}"
  #             entity_broken_count: >
  #               "{% raw %}{{ integration_entities('{% endraw %}{{attr}}{% raw %}')|select('has_value')|list|count }}{% endraw %}"
  #       {%- endif %}

  #       {# Add to the list by concatenating strings #}
  #       {%- set ns.non_existing_sensors = ns.non_existing_sensors + ',' + attr if ns.non_existing_sensors else attr %}
  #   {%- endif %}
  # {%- endfor %}

  # {# Handle orphaned sensors #}
  # {%- for state in states.binary_sensor | selectattr('entity_id', 'search', '^binary_sensor\\.ha_connected_integration_') %}
  #   {%- set attr = state.entity_id.split('binary_sensor.ha_connected_integration_')[1] %}

  #   {%- if attr not in states.sensor.start_time.attributes %}
  #     {# Add to orphaned list #}
  #     {%- set ns.orphaned_sensors = ns.orphaned_sensors + ',' + attr if ns.orphaned_sensors else attr %}
  #   {%- endif %}
  # {%- endfor %}

  # ### âœ… **List of Missing Sensors:**
  # {%- set missing_sensors = ns.non_existing_sensors.split(',') if ns.non_existing_sensors else [] -%}
  # {%- if missing_sensors | length > 0 %}
  # **The following sensors don't exist:**
  # {{ missing_sensors | join(', ') }}
  # {%- else %}
  # **All sensors are created!**
  # {%- endif %}

  # ---

  # ### ðŸš¨ **List of Orphaned Sensors:**
  # {%- set orphaned_sensors = ns.orphaned_sensors.split(',') if ns.orphaned_sensors else [] -%}
  # {%- if orphaned_sensors | length > 0 %}
  # **The following sensors are orphaned and no longer have valid attributes:**
  # {{ orphaned_sensors | join(', ') }}
  # {%- else %}
  # **No orphaned sensors found!**
  # {%- endif %}

  - name: "[HA Connected Integration] accuweather"
    unique_id: ha_connected_integration_accuweather
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/accuweather/icon.png
    device_class: connectivity
    state: "{{ integration_entities('accuweather')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('accuweather')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('accuweather')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] adaptive_lighting"
    unique_id: ha_connected_integration_adaptive_lighting
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/adaptive_lighting/icon.png
    device_class: connectivity
    state: "{{ integration_entities('adaptive_lighting')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('adaptive_lighting')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('adaptive_lighting')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] adguard"
    unique_id: ha_connected_integration_adguard
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/adguard/icon.png
    device_class: connectivity
    state: "{{ integration_entities('adguard')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('adguard')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('adguard')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] adsb_lol"
    unique_id: ha_connected_integration_adsb_lol
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/adsb_lol/icon.png
    device_class: connectivity
    state: "{{ integration_entities('adsb_lol')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('adsb_lol')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('adsb_lol')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] airvisual"
    unique_id: ha_connected_integration_airvisual
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/airvisual/icon.png
    device_class: connectivity
    state: "{{ integration_entities('airvisual')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('airvisual')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('airvisual')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] alert"
    unique_id: ha_connected_integration_alert
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/alert/icon.png
    device_class: connectivity
    state: "{{ integration_entities('alert')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('alert')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('alert')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] analytics_insights"
    unique_id: ha_connected_integration_analytics_insights
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/analytics_insights/icon.png
    device_class: connectivity
    state: "{{ integration_entities('analytics_insights')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('analytics_insights')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('analytics_insights')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] anniversaries"
    unique_id: ha_connected_integration_anniversaries
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/anniversaries/icon.png
    device_class: connectivity
    state: "{{ integration_entities('anniversaries')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('anniversaries')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('anniversaries')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] apple_tv"
    unique_id: ha_connected_integration_apple_tv
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/apple_tv/icon.png
    device_class: connectivity
    state: "{{ integration_entities('apple_tv')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('apple_tv')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('apple_tv')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] astroweather"
    unique_id: ha_connected_integration_astroweather
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/astroweather/icon.png
    device_class: connectivity
    state: "{{ integration_entities('astroweather')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('astroweather')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('astroweather')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] aurora"
    unique_id: ha_connected_integration_aurora
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/aurora/icon.png
    device_class: connectivity
    state: "{{ integration_entities('aurora')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('aurora')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('aurora')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] aus_space_weather"
    unique_id: ha_connected_integration_aus_space_weather
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/aus_space_weather/icon.png
    device_class: connectivity
    state: "{{ integration_entities('aus_space_weather')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('aus_space_weather')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('aus_space_weather')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] automation"
    unique_id: ha_connected_integration_automation
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/automation/icon.png
    device_class: connectivity
    state: "{{ integration_entities('automation')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('automation')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('automation')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] average"
    unique_id: ha_connected_integration_average
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/average/icon.png
    device_class: connectivity
    state: "{{ integration_entities('average')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('average')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('average')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] aviationweather"
    unique_id: ha_connected_integration_aviationweather
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/aviationweather/icon.png
    device_class: connectivity
    state: "{{ integration_entities('aviationweather')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('aviationweather')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('aviationweather')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] backup"
    unique_id: ha_connected_integration_backup
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/backup/icon.png
    device_class: connectivity
    state: "{{ integration_entities('backup')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('backup')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('backup')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] bayesian"
    unique_id: ha_connected_integration_bayesian
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/bayesian/icon.png
    device_class: connectivity
    state: "{{ integration_entities('bayesian')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('bayesian')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('bayesian')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] bermuda"
    unique_id: ha_connected_integration_bermuda
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/bermuda/icon.png
    device_class: connectivity
    state: "{{ integration_entities('bermuda')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('bermuda')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('bermuda')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] ble_monitor"
    unique_id: ha_connected_integration_ble_monitor
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/ble_monitor/icon.png
    device_class: connectivity
    state: "{{ integration_entities('ble_monitor')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('ble_monitor')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('ble_monitor')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] blitzortung"
    unique_id: ha_connected_integration_blitzortung
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/blitzortung/icon.png
    device_class: connectivity
    state: "{{ integration_entities('blitzortung')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('blitzortung')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('blitzortung')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] broadlink"
    unique_id: ha_connected_integration_broadlink
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/broadlink/icon.png
    device_class: connectivity
    state: "{{ integration_entities('broadlink')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('broadlink')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('broadlink')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] bureau_of_meteorology"
    unique_id: ha_connected_integration_bureau_of_meteorology
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/bureau_of_meteorology/icon.png
    device_class: connectivity
    state: "{{ integration_entities('bureau_of_meteorology')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('bureau_of_meteorology')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('bureau_of_meteorology')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] cast"
    unique_id: ha_connected_integration_cast
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/cast/icon.png
    device_class: connectivity
    state: "{{ integration_entities('cast')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('cast')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('cast')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] cert_expiry"
    unique_id: ha_connected_integration_cert_expiry
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/cert_expiry/icon.png
    device_class: connectivity
    state: "{{ integration_entities('cert_expiry')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('cert_expiry')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('cert_expiry')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] cloud"
    unique_id: ha_connected_integration_cloud
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/cloud/icon.png
    device_class: connectivity
    state: "{{ integration_entities('cloud')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('cloud')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('cloud')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] cloudflare_tunnel_monitor"
    unique_id: ha_connected_integration_cloudflare_tunnel_monitor
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/cloudflare_tunnel_monitor/icon.png
    device_class: connectivity
    state: "{{ integration_entities('cloudflare_tunnel_monitor')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('cloudflare_tunnel_monitor')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('cloudflare_tunnel_monitor')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] co2signal"
    unique_id: ha_connected_integration_co2signal
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/co2signal/icon.png
    device_class: connectivity
    state: "{{ integration_entities('co2signal')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('co2signal')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('co2signal')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] command_line"
    unique_id: ha_connected_integration_command_line
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/command_line/icon.png
    device_class: connectivity
    state: "{{ integration_entities('command_line')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('command_line')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('command_line')|reject('has_value')|list|count }}"

  # - name: "[HA Connected Integration] conversation"
  #   unique_id: ha_connected_integration_conversation
  #   icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
  #   picture: https://brands.home-assistant.io/conversation/icon.png
  #   device_class: connectivity
  #   state: "{{ integration_entities('conversation')|select('has_value')|list|count > 0 }}"
  #   attributes:
  #     category: homeassistant_connectivity
  #     entity_count: >
  #       "{{ integration_entities('conversation')|list|count }}"
  #     entity_broken_count: >
  #       "{{ integration_entities('conversation')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] counter"
    unique_id: ha_connected_integration_counter
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/counter/icon.png
    device_class: connectivity
    state: "{{ integration_entities('counter')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('counter')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('counter')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] daily"
    unique_id: ha_connected_integration_daily
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/daily/icon.png
    device_class: connectivity
    state: "{{ integration_entities('daily')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('daily')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('daily')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] derivative"
    unique_id: ha_connected_integration_derivative
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/derivative/icon.png
    device_class: connectivity
    state: "{{ integration_entities('derivative')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('derivative')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('derivative')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] docker_status"
    unique_id: ha_connected_integration_docker_status
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/docker_status/icon.png
    device_class: connectivity
    state: "{{ integration_entities('docker_status')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('docker_status')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('docker_status')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] doomsday_clock"
    unique_id: ha_connected_integration_doomsday_clock
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/doomsday_clock/icon.png
    device_class: connectivity
    state: "{{ integration_entities('doomsday_clock')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('doomsday_clock')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('doomsday_clock')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] dynamic_energy_cost"
    unique_id: ha_connected_integration_dynamic_energy_cost
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/dynamic_energy_cost/icon.png
    device_class: connectivity
    state: "{{ integration_entities('dynamic_energy_cost')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('dynamic_energy_cost')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('dynamic_energy_cost')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] dyson_local"
    unique_id: ha_connected_integration_dyson_local
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/dyson_local/icon.png
    device_class: connectivity
    state: "{{ integration_entities('dyson_local')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('dyson_local')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('dyson_local')|reject('has_value')|list|count }}"

  # - name: "[HA Connected Integration] emsc_earthquake"
  #   unique_id: ha_connected_integration_emsc_earthquake
  #   icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
  #   picture: https://brands.home-assistant.io/emsc_earthquake/icon.png
  #   device_class: connectivity
  #   state: "{{ integration_entities('emsc_earthquake')|select('has_value')|list|count > 0 }}"
  #   attributes:
  #     category: homeassistant_connectivity
  #     entity_count: >
  #       "{{ integration_entities('emsc_earthquake')|list|count }}"
  #     entity_broken_count: >
  #       "{{ integration_entities('emsc_earthquake')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] energy"
    unique_id: ha_connected_integration_energy
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/energy/icon.png
    device_class: connectivity
    state: "{{ integration_entities('energy')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('energy')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('energy')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] esphome"
    unique_id: ha_connected_integration_esphome
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/esphome/icon.png
    device_class: connectivity
    state: "{{ integration_entities('esphome')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('esphome')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('esphome')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] eufy_security"
    unique_id: ha_connected_integration_eufy_security
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/eufy_security/icon.png
    device_class: connectivity
    state: "{{ integration_entities('eufy_security')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('eufy_security')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('eufy_security')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] f1_sensor"
    unique_id: ha_connected_integration_f1_sensor
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/f1_sensor/icon.png
    device_class: connectivity
    state: "{{ integration_entities('f1_sensor')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('f1_sensor')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('f1_sensor')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] fastdotcom"
    unique_id: ha_connected_integration_fastdotcom
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/fastdotcom/icon.png
    device_class: connectivity
    state: "{{ integration_entities('fastdotcom')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('fastdotcom')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('fastdotcom')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] feedparser"
    unique_id: ha_connected_integration_feedparser
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/feedparser/icon.png
    device_class: connectivity
    state: "{{ integration_entities('feedparser')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('feedparser')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('feedparser')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] filter"
    unique_id: ha_connected_integration_filter
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/filter/icon.png
    device_class: connectivity
    state: "{{ integration_entities('filter')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('filter')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('filter')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] flightradar24"
    unique_id: ha_connected_integration_flightradar24
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/flightradar24/icon.png
    device_class: connectivity
    state: "{{ integration_entities('flightradar24')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('flightradar24')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('flightradar24')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] folder"
    unique_id: ha_connected_integration_folder
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/folder/icon.png
    device_class: connectivity
    state: "{{ integration_entities('folder')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('folder')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('folder')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] forecast_solar"
    unique_id: ha_connected_integration_forecast_solar
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/forecast_solar/icon.png
    device_class: connectivity
    state: "{{ integration_entities('forecast_solar')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('forecast_solar')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('forecast_solar')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] fuel_prices"
    unique_id: ha_connected_integration_fuel_prices
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/fuel_prices/icon.png
    device_class: connectivity
    state: "{{ integration_entities('fuel_prices')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('fuel_prices')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('fuel_prices')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] fully_kiosk"
    unique_id: ha_connected_integration_fully_kiosk
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/fully_kiosk/icon.png
    device_class: connectivity
    state: "{{ integration_entities('fully_kiosk')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('fully_kiosk')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('fully_kiosk')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] garbage_collection"
    unique_id: ha_connected_integration_garbage_collection
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/garbage_collection/icon.png
    device_class: connectivity
    state: "{{ integration_entities('garbage_collection')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('garbage_collection')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('garbage_collection')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] gdacs"
    unique_id: ha_connected_integration_gdacs
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/gdacs/icon.png
    device_class: connectivity
    state: "{{ integration_entities('gdacs')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('gdacs')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('gdacs')|reject('has_value')|list|count }}"

  # - name: "[HA Connected Integration] geo_json_events"
  #   unique_id: ha_connected_integration_geo_json_events
  #   icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
  #   picture: https://brands.home-assistant.io/geo_json_events/icon.png
  #   device_class: connectivity
  #   state: "{{ integration_entities('geo_json_events')|select('has_value')|list|count > 0 }}"
  #   attributes:
  #     category: homeassistant_connectivity
  #     entity_count: >
  #       "{{ integration_entities('geo_json_events')|list|count }}"
  #     entity_broken_count: >
  #       "{{ integration_entities('geo_json_events')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] github"
    unique_id: ha_connected_integration_github
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/github/icon.png
    device_class: connectivity
    state: "{{ integration_entities('github')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('github')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('github')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] google"
    unique_id: ha_connected_integration_google
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/google/icon.png
    device_class: connectivity
    state: "{{ integration_entities('google')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('google')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('google')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] google_home"
    unique_id: ha_connected_integration_google_home
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/google_home/icon.png
    device_class: connectivity
    state: "{{ integration_entities('google_home')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('google_home')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('google_home')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] group"
    unique_id: ha_connected_integration_group
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/group/icon.png
    device_class: connectivity
    state: "{{ integration_entities('group')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('group')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('group')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] gtfs2"
    unique_id: ha_connected_integration_gtfs2
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/gtfs2/icon.png
    device_class: connectivity
    state: "{{ integration_entities('gtfs2')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('gtfs2')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('gtfs2')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] gtfs_realtime"
    unique_id: ha_connected_integration_gtfs_realtime
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/gtfs_realtime/icon.png
    device_class: connectivity
    state: "{{ integration_entities('gtfs_realtime')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('gtfs_realtime')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('gtfs_realtime')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] hacs"
    unique_id: ha_connected_integration_hacs
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/hacs/icon.png
    device_class: connectivity
    state: "{{ integration_entities('hacs')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('hacs')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('hacs')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] harmony"
    unique_id: ha_connected_integration_harmony
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/harmony/icon.png
    device_class: connectivity
    state: "{{ integration_entities('harmony')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('harmony')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('harmony')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] hassio"
    unique_id: ha_connected_integration_hassio
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/hassio/icon.png
    device_class: connectivity
    state: "{{ integration_entities('hassio')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('hassio')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('hassio')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] haveibeenpwned"
    unique_id: ha_connected_integration_haveibeenpwned
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/haveibeenpwned/icon.png
    device_class: connectivity
    state: "{{ integration_entities('haveibeenpwned')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('haveibeenpwned')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('haveibeenpwned')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] hdhomerun"
    unique_id: ha_connected_integration_hdhomerun
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/hdhomerun/icon.png
    device_class: connectivity
    state: "{{ integration_entities('hdhomerun')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('hdhomerun')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('hdhomerun')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] here_travel_time"
    unique_id: ha_connected_integration_here_travel_time
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/here_travel_time/icon.png
    device_class: connectivity
    state: "{{ integration_entities('here_travel_time')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('here_travel_time')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('here_travel_time')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] history_stats"
    unique_id: ha_connected_integration_history_stats
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/history_stats/icon.png
    device_class: connectivity
    state: "{{ integration_entities('history_stats')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('history_stats')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('history_stats')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] holiday"
    unique_id: ha_connected_integration_holiday
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/holiday/icon.png
    device_class: connectivity
    state: "{{ integration_entities('holiday')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('holiday')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('holiday')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] holidays"
    unique_id: ha_connected_integration_holidays
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/holidays/icon.png
    device_class: connectivity
    state: "{{ integration_entities('holidays')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('holidays')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('holidays')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] homeassistant"
    unique_id: ha_connected_integration_homeassistant
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/homeassistant/icon.png
    device_class: connectivity
    state: "{{ integration_entities('homeassistant')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('homeassistant')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('homeassistant')|reject('has_value')|list|count }}"

  # - name: "[HA Connected Integration] homeassistant_sky_connect"
  #   unique_id: ha_connected_integration_homeassistant_sky_connect
  #   icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
  #   picture: https://brands.home-assistant.io/homeassistant_sky_connect/icon.png
  #   device_class: connectivity
  #   state: "{{ integration_entities('homeassistant_sky_connect')|select('has_value')|list|count > 0 }}"
  #   attributes:
  #     category: homeassistant_connectivity
  #     entity_count: >
  #       "{{ integration_entities('homeassistant_sky_connect')|list|count }}"
  #     entity_broken_count: >
  #       "{{ integration_entities('homeassistant_sky_connect')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] iaquk"
    unique_id: ha_connected_integration_iaquk
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/iaquk/icon.png
    device_class: connectivity
    state: "{{ integration_entities('iaquk')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('iaquk')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('iaquk')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] ibeacon"
    unique_id: ha_connected_integration_ibeacon
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/ibeacon/icon.png
    device_class: connectivity
    state: "{{ integration_entities('ibeacon')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('ibeacon')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('ibeacon')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] ics_calendar"
    unique_id: ha_connected_integration_ics_calendar
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/ics_calendar/icon.png
    device_class: connectivity
    state: "{{ integration_entities('ics_calendar')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('ics_calendar')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('ics_calendar')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] illuminance"
    unique_id: ha_connected_integration_illuminance
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/illuminance/icon.png
    device_class: connectivity
    state: "{{ integration_entities('illuminance')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('illuminance')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('illuminance')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] input_boolean"
    unique_id: ha_connected_integration_input_boolean
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/input_boolean/icon.png
    device_class: connectivity
    state: "{{ integration_entities('input_boolean')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('input_boolean')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('input_boolean')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] input_number"
    unique_id: ha_connected_integration_input_number
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/input_number/icon.png
    device_class: connectivity
    state: "{{ integration_entities('input_number')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('input_number')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('input_number')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] input_select"
    unique_id: ha_connected_integration_input_select
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/input_select/icon.png
    device_class: connectivity
    state: "{{ integration_entities('input_select')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('input_select')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('input_select')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] input_text"
    unique_id: ha_connected_integration_input_text
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/input_text/icon.png
    device_class: connectivity
    state: "{{ integration_entities('input_text')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('input_text')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('input_text')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] integration"
    unique_id: ha_connected_integration_integration
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/integration/icon.png
    device_class: connectivity
    state: "{{ integration_entities('integration')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('integration')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('integration')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] lastfm"
    unique_id: ha_connected_integration_lastfm
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/lastfm/icon.png
    device_class: connectivity
    state: "{{ integration_entities('lastfm')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('lastfm')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('lastfm')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] lg_thinq"
    unique_id: ha_connected_integration_lg_thinq
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/lg_thinq/icon.png
    device_class: connectivity
    state: "{{ integration_entities('lg_thinq')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('lg_thinq')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('lg_thinq')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] local_ip"
    unique_id: ha_connected_integration_local_ip
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/local_ip/icon.png
    device_class: connectivity
    state: "{{ integration_entities('local_ip')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('local_ip')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('local_ip')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] lunar_phase"
    unique_id: ha_connected_integration_lunar_phase
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/lunar_phase/icon.png
    device_class: connectivity
    state: "{{ integration_entities('lunar_phase')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('lunar_phase')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('lunar_phase')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] mastodon"
    unique_id: ha_connected_integration_mastodon
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/mastodon/icon.png
    device_class: connectivity
    state: "{{ integration_entities('mastodon')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('mastodon')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('mastodon')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] matter"
    unique_id: ha_connected_integration_matter
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/matter/icon.png
    device_class: connectivity
    state: "{{ integration_entities('matter')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('matter')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('matter')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] met"
    unique_id: ha_connected_integration_met
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/met/icon.png
    device_class: connectivity
    state: "{{ integration_entities('met')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('met')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('met')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] mobile_app"
    unique_id: ha_connected_integration_mobile_app
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/mobile_app/icon.png
    device_class: connectivity
    state: "{{ integration_entities('mobile_app')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('mobile_app')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('mobile_app')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] monitor_docker"
    unique_id: ha_connected_integration_monitor_docker
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/monitor_docker/icon.png
    device_class: connectivity
    state: "{{ integration_entities('monitor_docker')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('monitor_docker')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('monitor_docker')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] moon"
    unique_id: ha_connected_integration_moon
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/moon/icon.png
    device_class: connectivity
    state: "{{ integration_entities('moon')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('moon')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('moon')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] mqtt"
    unique_id: ha_connected_integration_mqtt
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/mqtt/icon.png
    device_class: connectivity
    state: "{{ integration_entities('mqtt')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('mqtt')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('mqtt')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] multiscrape"
    unique_id: ha_connected_integration_multiscrape
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/multiscrape/icon.png
    device_class: connectivity
    state: "{{ integration_entities('multiscrape')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('multiscrape')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('multiscrape')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] music_assistant"
    unique_id: ha_connected_integration_music_assistant
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/music_assistant/icon.png
    device_class: connectivity
    state: "{{ integration_entities('music_assistant')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('music_assistant')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('music_assistant')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] myjdownloader"
    unique_id: ha_connected_integration_myjdownloader
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/myjdownloader/icon.png
    device_class: connectivity
    state: "{{ integration_entities('myjdownloader')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('myjdownloader')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('myjdownloader')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] network_scanner"
    unique_id: ha_connected_integration_network_scanner
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/network_scanner/icon.png
    device_class: connectivity
    state: "{{ integration_entities('network_scanner')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('network_scanner')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('network_scanner')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] nodered"
    unique_id: ha_connected_integration_nodered
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/nodered/icon.png
    device_class: connectivity
    state: "{{ integration_entities('nodered')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('nodered')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('nodered')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] nsw_air_quality"
    unique_id: ha_connected_integration_nsw_air_quality
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/nsw_air_quality/icon.png
    device_class: connectivity
    state: "{{ integration_entities('nsw_air_quality')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('nsw_air_quality')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('nsw_air_quality')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] nsw_fuel_station"
    unique_id: ha_connected_integration_nsw_fuel_station
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/nsw_fuel_station/icon.png
    device_class: connectivity
    state: "{{ integration_entities('nsw_fuel_station')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('nsw_fuel_station')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('nsw_fuel_station')|reject('has_value')|list|count }}"

  # - name: "[HA Connected Integration] nsw_rural_fire_service_feed"
  #   unique_id: ha_connected_integration_nsw_rural_fire_service_feed
  #   icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
  #   picture: https://brands.home-assistant.io/nsw_rural_fire_service_feed/icon.png
  #   device_class: connectivity
  #   state: "{{ integration_entities('nsw_rural_fire_service_feed')|select('has_value')|list|count > 0 }}"
  #   attributes:
  #     category: homeassistant_connectivity
  #     entity_count: >
  #       "{{ integration_entities('nsw_rural_fire_service_feed')|list|count }}"
  #     entity_broken_count: >
  #       "{{ integration_entities('nsw_rural_fire_service_feed')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] nsw_rural_fire_service_fire_danger"
    unique_id: ha_connected_integration_nsw_rural_fire_service_fire_danger
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/nsw_rural_fire_service_fire_danger/icon.png
    device_class: connectivity
    state: "{{ integration_entities('nsw_rural_fire_service_fire_danger')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('nsw_rural_fire_service_fire_danger')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('nsw_rural_fire_service_fire_danger')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] open_meteo"
    unique_id: ha_connected_integration_open_meteo
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/open_meteo/icon.png
    device_class: connectivity
    state: "{{ integration_entities('open_meteo')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('open_meteo')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('open_meteo')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] open_meteo_solar_forecast"
    unique_id: ha_connected_integration_open_meteo_solar_forecast
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/open_meteo_solar_forecast/icon.png
    device_class: connectivity
    state: "{{ integration_entities('open_meteo_solar_forecast')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('open_meteo_solar_forecast')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('open_meteo_solar_forecast')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] opennem"
    unique_id: ha_connected_integration_opennem
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/opennem/icon.png
    device_class: connectivity
    state: "{{ integration_entities('opennem')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('opennem')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('opennem')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] openuv"
    unique_id: ha_connected_integration_openuv
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/openuv/icon.png
    device_class: connectivity
    state: "{{ integration_entities('openuv')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('openuv')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('openuv')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] openweathermap"
    unique_id: ha_connected_integration_openweathermap
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/openweathermap/icon.png
    device_class: connectivity
    state: "{{ integration_entities('openweathermap')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('openweathermap')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('openweathermap')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] person"
    unique_id: ha_connected_integration_person
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/person/icon.png
    device_class: connectivity
    state: "{{ integration_entities('person')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('person')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('person')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] ping"
    unique_id: ha_connected_integration_ping
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/ping/icon.png
    device_class: connectivity
    state: "{{ integration_entities('ping')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('ping')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('ping')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] pirateweather"
    unique_id: ha_connected_integration_pirateweather
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/pirateweather/icon.png
    device_class: connectivity
    state: "{{ integration_entities('pirateweather')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('pirateweather')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('pirateweather')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] plex"
    unique_id: ha_connected_integration_plex
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/plex/icon.png
    device_class: connectivity
    state: "{{ integration_entities('plex')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('plex')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('plex')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] plex_recently_added"
    unique_id: ha_connected_integration_plex_recently_added
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/plex_recently_added/icon.png
    device_class: connectivity
    state: "{{ integration_entities('plex_recently_added')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('plex_recently_added')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('plex_recently_added')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] pocketcasts"
    unique_id: ha_connected_integration_pocketcasts
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/pocketcasts/icon.png
    device_class: connectivity
    state: "{{ integration_entities('pocketcasts')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('pocketcasts')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('pocketcasts')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] powercalc"
    unique_id: ha_connected_integration_powercalc
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/powercalc/icon.png
    device_class: connectivity
    state: "{{ integration_entities('powercalc')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('powercalc')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('powercalc')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] private_ble_device"
    unique_id: ha_connected_integration_private_ble_device
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/private_ble_device/icon.png
    device_class: connectivity
    state: "{{ integration_entities('private_ble_device')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('private_ble_device')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('private_ble_device')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] prometheus_query"
    unique_id: ha_connected_integration_prometheus_query
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/prometheus_query/icon.png
    device_class: connectivity
    state: "{{ integration_entities('prometheus_query')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('prometheus_query')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('prometheus_query')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] prometheus_sensor"
    unique_id: ha_connected_integration_prometheus_sensor
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/prometheus_sensor/icon.png
    device_class: connectivity
    state: "{{ integration_entities('prometheus_sensor')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('prometheus_sensor')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('prometheus_sensor')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] proximity"
    unique_id: ha_connected_integration_proximity
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/proximity/icon.png
    device_class: connectivity
    state: "{{ integration_entities('proximity')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('proximity')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('proximity')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] proxmoxve"
    unique_id: ha_connected_integration_proxmoxve
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/proxmoxve/icon.png
    device_class: connectivity
    state: "{{ integration_entities('proxmoxve')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('proxmoxve')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('proxmoxve')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] qbittorrent"
    unique_id: ha_connected_integration_qbittorrent
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/qbittorrent/icon.png
    device_class: connectivity
    state: "{{ integration_entities('qbittorrent')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('qbittorrent')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('qbittorrent')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] qbittorrent_alt"
    unique_id: ha_connected_integration_qbittorrent_alt
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/qbittorrent_alt/icon.png
    device_class: connectivity
    state: "{{ integration_entities('qbittorrent_alt')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('qbittorrent_alt')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('qbittorrent_alt')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] radarr"
    unique_id: ha_connected_integration_radarr
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/radarr/icon.png
    device_class: connectivity
    state: "{{ integration_entities('radarr')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('radarr')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('radarr')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] radarr_upcoming_media"
    unique_id: ha_connected_integration_radarr_upcoming_media
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/radarr_upcoming_media/icon.png
    device_class: connectivity
    state: "{{ integration_entities('radarr_upcoming_media')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('radarr_upcoming_media')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('radarr_upcoming_media')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] remote_calendar"
    unique_id: ha_connected_integration_remote_calendar
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/remote_calendar/icon.png
    device_class: connectivity
    state: "{{ integration_entities('remote_calendar')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('remote_calendar')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('remote_calendar')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] rest"
    unique_id: ha_connected_integration_rest
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/rest/icon.png
    device_class: connectivity
    state: "{{ integration_entities('rest')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('rest')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('rest')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] sabnzbd"
    unique_id: ha_connected_integration_sabnzbd
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/sabnzbd/icon.png
    device_class: connectivity
    state: "{{ integration_entities('sabnzbd')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('sabnzbd')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('sabnzbd')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] satellitetracker"
    unique_id: ha_connected_integration_satellitetracker
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/satellitetracker/icon.png
    device_class: connectivity
    state: "{{ integration_entities('satellitetracker')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('satellitetracker')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('satellitetracker')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] schedule"
    unique_id: ha_connected_integration_schedule
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/schedule/icon.png
    device_class: connectivity
    state: "{{ integration_entities('schedule')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('schedule')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('schedule')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] script"
    unique_id: ha_connected_integration_script
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/script/icon.png
    device_class: connectivity
    state: "{{ integration_entities('script')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('script')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('script')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] season"
    unique_id: ha_connected_integration_season
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/season/icon.png
    device_class: connectivity
    state: "{{ integration_entities('season')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('season')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('season')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] sensibo"
    unique_id: ha_connected_integration_sensibo
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/sensibo/icon.png
    device_class: connectivity
    state: "{{ integration_entities('sensibo')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('sensibo')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('sensibo')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] smartthinq_sensors"
    unique_id: ha_connected_integration_smartthinq_sensors
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/smartthinq_sensors/icon.png
    device_class: connectivity
    state: "{{ integration_entities('smartthinq_sensors')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('smartthinq_sensors')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('smartthinq_sensors')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] snmp"
    unique_id: ha_connected_integration_snmp
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/snmp/icon.png
    device_class: connectivity
    state: "{{ integration_entities('snmp')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('snmp')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('snmp')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] solcast_solar"
    unique_id: ha_connected_integration_solcast_solar
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/solcast_solar/icon.png
    device_class: connectivity
    state: "{{ integration_entities('solcast_solar')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('solcast_solar')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('solcast_solar')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] sonarr"
    unique_id: ha_connected_integration_sonarr
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/sonarr/icon.png
    device_class: connectivity
    state: "{{ integration_entities('sonarr')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('sonarr')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('sonarr')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] sonarr_upcoming_media"
    unique_id: ha_connected_integration_sonarr_upcoming_media
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/sonarr_upcoming_media/icon.png
    device_class: connectivity
    state: "{{ integration_entities('sonarr_upcoming_media')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('sonarr_upcoming_media')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('sonarr_upcoming_media')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] sonos"
    unique_id: ha_connected_integration_sonos
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/sonos/icon.png
    device_class: connectivity
    state: "{{ integration_entities('sonos')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('sonos')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('sonos')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] speedtestdotnet"
    unique_id: ha_connected_integration_speedtestdotnet
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/speedtestdotnet/icon.png
    device_class: connectivity
    state: "{{ integration_entities('speedtestdotnet')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('speedtestdotnet')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('speedtestdotnet')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] spook"
    unique_id: ha_connected_integration_spook
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/spook/icon.png
    device_class: connectivity
    state: "{{ integration_entities('spook')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('spook')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('spook')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] spotify"
    unique_id: ha_connected_integration_spotify
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/spotify/icon.png
    device_class: connectivity
    state: "{{ integration_entities('spotify')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('spotify')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('spotify')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] spotifyplus"
    unique_id: ha_connected_integration_spotifyplus
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/spotifyplus/icon.png
    device_class: connectivity
    state: "{{ integration_entities('spotifyplus')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('spotifyplus')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('spotifyplus')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] sql"
    unique_id: ha_connected_integration_sql
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/sql/icon.png
    device_class: connectivity
    state: "{{ integration_entities('sql')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('sql')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('sql')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] sql_json"
    unique_id: ha_connected_integration_sql_json
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/sql_json/icon.png
    device_class: connectivity
    state: "{{ integration_entities('sql_json')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('sql_json')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('sql_json')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] starlink"
    unique_id: ha_connected_integration_starlink
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/starlink/icon.png
    device_class: connectivity
    state: "{{ integration_entities('starlink')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('starlink')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('starlink')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] start_time"
    unique_id: ha_connected_integration_start_time
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/start_time/icon.png
    device_class: connectivity
    state: "{{ integration_entities('start_time')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('start_time')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('start_time')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] statistics"
    unique_id: ha_connected_integration_statistics
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/statistics/icon.png
    device_class: connectivity
    state: "{{ integration_entities('statistics')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('statistics')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('statistics')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] sun"
    unique_id: ha_connected_integration_sun
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/sun/icon.png
    device_class: connectivity
    state: "{{ integration_entities('sun')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('sun')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('sun')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] sun2"
    unique_id: ha_connected_integration_sun2
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/sun2/icon.png
    device_class: connectivity
    state: "{{ integration_entities('sun2')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('sun2')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('sun2')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] swatch_time"
    unique_id: ha_connected_integration_swatch_time
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/swatch_time/icon.png
    device_class: connectivity
    state: "{{ integration_entities('swatch_time')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('swatch_time')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('swatch_time')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] synology_dsm"
    unique_id: ha_connected_integration_synology_dsm
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/synology_dsm/icon.png
    device_class: connectivity
    state: "{{ integration_entities('synology_dsm')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('synology_dsm')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('synology_dsm')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] systemmonitor"
    unique_id: ha_connected_integration_systemmonitor
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/systemmonitor/icon.png
    device_class: connectivity
    state: "{{ integration_entities('systemmonitor')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('systemmonitor')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('systemmonitor')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] tag"
    unique_id: ha_connected_integration_tag
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/tag/icon.png
    device_class: connectivity
    state: "{{ integration_entities('tag')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('tag')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('tag')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] tautulli"
    unique_id: ha_connected_integration_tautulli
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/tautulli/icon.png
    device_class: connectivity
    state: "{{ integration_entities('tautulli')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('tautulli')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('tautulli')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] teamtracker"
    unique_id: ha_connected_integration_teamtracker
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/teamtracker/icon.png
    device_class: connectivity
    state: "{{ integration_entities('teamtracker')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('teamtracker')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('teamtracker')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] temperature_feels_like"
    unique_id: ha_connected_integration_temperature_feels_like
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/temperature_feels_like/icon.png
    device_class: connectivity
    state: "{{ integration_entities('temperature_feels_like')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('temperature_feels_like')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('temperature_feels_like')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] template"
    unique_id: ha_connected_integration_template
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/template/icon.png
    device_class: connectivity
    state: "{{ integration_entities('template')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('template')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('template')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] thermal_comfort"
    unique_id: ha_connected_integration_thermal_comfort
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/thermal_comfort/icon.png
    device_class: connectivity
    state: "{{ integration_entities('thermal_comfort')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('thermal_comfort')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('thermal_comfort')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] time_date"
    unique_id: ha_connected_integration_time_date
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/time_date/icon.png
    device_class: connectivity
    state: "{{ integration_entities('time_date')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('time_date')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('time_date')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] timer"
    unique_id: ha_connected_integration_timer
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/timer/icon.png
    device_class: connectivity
    state: "{{ integration_entities('timer')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('timer')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('timer')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] tod"
    unique_id: ha_connected_integration_tod
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/tod/icon.png
    device_class: connectivity
    state: "{{ integration_entities('tod')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('tod')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('tod')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] tomorrowio"
    unique_id: ha_connected_integration_tomorrowio
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/tomorrowio/icon.png
    device_class: connectivity
    state: "{{ integration_entities('tomorrowio')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('tomorrowio')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('tomorrowio')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] trend"
    unique_id: ha_connected_integration_trend
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/trend/icon.png
    device_class: connectivity
    state: "{{ integration_entities('trend')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('trend')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('trend')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] tuya"
    unique_id: ha_connected_integration_tuya
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/tuya/icon.png
    device_class: connectivity
    state: "{{ integration_entities('tuya')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('tuya')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('tuya')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] unifi"
    unique_id: ha_connected_integration_unifi
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/unifi/icon.png
    device_class: connectivity
    state: "{{ integration_entities('unifi')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('unifi')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('unifi')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] unifi_insights"
    unique_id: ha_connected_integration_unifi_insights
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/unifi_insights/icon.png
    device_class: connectivity
    state: "{{ integration_entities('unifi_insights')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('unifi_insights')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('unifi_insights')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] unifi_site_manager"
    unique_id: ha_connected_integration_unifi_site_manager
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/unifi_site_manager/icon.png
    device_class: connectivity
    state: "{{ integration_entities('unifi_site_manager')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('unifi_site_manager')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('unifi_site_manager')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] universal"
    unique_id: ha_connected_integration_universal
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/universal/icon.png
    device_class: connectivity
    state: "{{ integration_entities('universal')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('universal')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('universal')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] untappd"
    unique_id: ha_connected_integration_untappd
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/untappd/icon.png
    device_class: connectivity
    state: "{{ integration_entities('untappd')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('untappd')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('untappd')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] uptime"
    unique_id: ha_connected_integration_uptime
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/uptime/icon.png
    device_class: connectivity
    state: "{{ integration_entities('uptime')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('uptime')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('uptime')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] uptime_kuma"
    unique_id: ha_connected_integration_uptime_kuma
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/uptime_kuma/icon.png
    device_class: connectivity
    state: "{{ integration_entities('uptime_kuma')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('uptime_kuma')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('uptime_kuma')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] utility_meter"
    unique_id: ha_connected_integration_utility_meter
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/utility_meter/icon.png
    device_class: connectivity
    state: "{{ integration_entities('utility_meter')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('utility_meter')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('utility_meter')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] version"
    unique_id: ha_connected_integration_version
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/version/icon.png
    device_class: connectivity
    state: "{{ integration_entities('version')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('version')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('version')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] waqi"
    unique_id: ha_connected_integration_waqi
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/waqi/icon.png
    device_class: connectivity
    state: "{{ integration_entities('waqi')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('waqi')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('waqi')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] watchman"
    unique_id: ha_connected_integration_watchman
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/watchman/icon.png
    device_class: connectivity
    state: "{{ integration_entities('watchman')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('watchman')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('watchman')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] waternsw"
    unique_id: ha_connected_integration_waternsw
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/waternsw/icon.png
    device_class: connectivity
    state: "{{ integration_entities('waternsw')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('waternsw')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('waternsw')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] weatherflow"
    unique_id: ha_connected_integration_weatherflow
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/weatherflow/icon.png
    device_class: connectivity
    state: "{{ integration_entities('weatherflow')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('weatherflow')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('weatherflow')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] weatherflow_cloud"
    unique_id: ha_connected_integration_weatherflow_cloud
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/weatherflow_cloud/icon.png
    device_class: connectivity
    state: "{{ integration_entities('weatherflow_cloud')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('weatherflow_cloud')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('weatherflow_cloud')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] weatherflow_forecast"
    unique_id: ha_connected_integration_weatherflow_forecast
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/weatherflow_forecast/icon.png
    device_class: connectivity
    state: "{{ integration_entities('weatherflow_forecast')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('weatherflow_forecast')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('weatherflow_forecast')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] webostv"
    unique_id: ha_connected_integration_webostv
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/webostv/icon.png
    device_class: connectivity
    state: "{{ integration_entities('webostv')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('webostv')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('webostv')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] whoop"
    unique_id: ha_connected_integration_whoop
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/whoop/icon.png
    device_class: connectivity
    state: "{{ integration_entities('whoop')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('whoop')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('whoop')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] withings"
    unique_id: ha_connected_integration_withings
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/withings/icon.png
    device_class: connectivity
    state: "{{ integration_entities('withings')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('withings')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('withings')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] workday"
    unique_id: ha_connected_integration_workday
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/workday/icon.png
    device_class: connectivity
    state: "{{ integration_entities('workday')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('workday')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('workday')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] worldclock"
    unique_id: ha_connected_integration_worldclock
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/worldclock/icon.png
    device_class: connectivity
    state: "{{ integration_entities('worldclock')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('worldclock')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('worldclock')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] worlds_air_quality_index"
    unique_id: ha_connected_integration_worlds_air_quality_index
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/worlds_air_quality_index/icon.png
    device_class: connectivity
    state: "{{ integration_entities('worlds_air_quality_index')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('worlds_air_quality_index')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('worlds_air_quality_index')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] wud_getupdates"
    unique_id: ha_connected_integration_wud_getupdates
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/wud_getupdates/icon.png
    device_class: connectivity
    state: "{{ integration_entities('wud_getupdates')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('wud_getupdates')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('wud_getupdates')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] xtend_tuya"
    unique_id: ha_connected_integration_xtend_tuya
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/xtend_tuya/icon.png
    device_class: connectivity
    state: "{{ integration_entities('xtend_tuya')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('xtend_tuya')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('xtend_tuya')|select('has_value')|list|count }}"

  - name: "[HA Connected Integration] yahoofinance"
    unique_id: ha_connected_integration_yahoofinance
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/yahoofinance/icon.png
    device_class: connectivity
    state: "{{ integration_entities('yahoofinance')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('yahoofinance')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('yahoofinance')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] youtube"
    unique_id: ha_connected_integration_youtube
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/youtube/icon.png
    device_class: connectivity
    state: "{{ integration_entities('youtube')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('youtube')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('youtube')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] zodiac"
    unique_id: ha_connected_integration_zodiac
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/zodiac/icon.png
    device_class: connectivity
    state: "{{ integration_entities('zodiac')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('zodiac')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('zodiac')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] zone"
    unique_id: ha_connected_integration_zone
    icon: "{{ iif(states(this.entity_id) == '0','mdi:sync','mdi:sync-alert') }}"
    picture: https://brands.home-assistant.io/zone/icon.png
    device_class: connectivity
    state: "{{ integration_entities('zone')|select('has_value')|list|count > 0 }}"
    attributes:
      category: homeassistant_connectivity
      entity_count: >
        "{{ integration_entities('zone')|list|count }}"
      entity_broken_count: >
        "{{ integration_entities('zone')|reject('has_value')|list|count }}"

  - name: "[HA Connected Integration] Bluetooth"
    unique_id: ha_connected_integrationbluetooth
    icon: mdi:bluetooth
    device_class: connectivity
    picture: https://brands.home-assistant.io/bluetooth/icon.png
    state: >
      {{ (expand(state_attr('sensor.devices_bluetooth', 'entity_id'))
            | selectattr('state', 'eq', 'home') | list | count > 0
          or expand(state_attr('sensor.devices_bluetooth_le', 'entity_id'))
            | selectattr('state', 'eq', 'home') | list | count > 0)
          and is_state('input_boolean.alerts_bluetooth','on') }}
    attributes:
      category: homeassistant_connectivity

  - name: "[HA Connected Integration] Offline Integrations"
    unique_id: ha_connected_integration_offline_integrations
    icon: >
      {{ iif(expand('group.connectivity_monitors')
        | selectattr('state','eq','off')
        | rejectattr('entity_id', 'in', this.entity_id)
        |map(attribute='entity_id')|list|sort|count == '0','mdi:api','mdi:api-off') }}"
    device_class: connectivity
    state: >
      {{ expand('group.connectivity_monitors')
            |selectattr('state','eq','off')|map(attribute='entity_id')|list|sort | count > 0 }}
    attributes:
      category: homeassistant_connectivity
      count: >
        {{ expand('group.connectivity_monitors')
            | rejectattr('entity_id', 'in', this.entity_id)
            |selectattr('state','eq','off')|map(attribute='entity_id')|list|sort | count }}
      entity_id: >
        {{ expand('group.connectivity_monitors')
            | rejectattr('entity_id', 'in', this.entity_id)
            |selectattr('state','eq','off')|map(attribute='entity_id')|list|sort }}
      integrations: >
        {{ expand('group.connectivity_monitors')
            | rejectattr('entity_id', 'in', this.entity_id)
            |selectattr('state','eq','off')|map(attribute='entity_id')|list|sort|replace("binary_sensor.ha_connected_integration_","") }}
