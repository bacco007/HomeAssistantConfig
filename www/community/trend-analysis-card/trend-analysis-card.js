function e(e,t,r,s){var n,i=arguments.length,a=i<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,s);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}"function"==typeof SuppressedError&&SuppressedError;const t=globalThis,r=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s=Symbol(),n=new WeakMap;let i=class{constructor(e,t,r){if(this._$cssResult$=!0,r!==s)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(r&&void 0===e){const r=void 0!==t&&1===t.length;r&&(e=n.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&n.set(t,e))}return e}toString(){return this.cssText}};const a=r?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const r of e.cssRules)t+=r.cssText;return(e=>new i("string"==typeof e?e:e+"",void 0,s))(t)})(e):e,{is:o,defineProperty:d,getOwnPropertyDescriptor:c,getOwnPropertyNames:l,getOwnPropertySymbols:h,getPrototypeOf:p}=Object,u=globalThis,g=u.trustedTypes,v=g?g.emptyScript:"",m=u.reactiveElementPolyfillSupport,_=(e,t)=>e,f={toAttribute(e,t){switch(t){case Boolean:e=e?v:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let r=e;switch(t){case Boolean:r=null!==e;break;case Number:r=null===e?null:Number(e);break;case Object:case Array:try{r=JSON.parse(e)}catch(e){r=null}}return r}},b=(e,t)=>!o(e,t),x={attribute:!0,type:String,converter:f,reflect:!1,useDefault:!1,hasChanged:b};Symbol.metadata??=Symbol("metadata"),u.litPropertyMetadata??=new WeakMap;let y=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=x){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,t);void 0!==s&&d(this.prototype,e,s)}}static getPropertyDescriptor(e,t,r){const{get:s,set:n}=c(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get:s,set(t){const i=s?.call(this);n?.call(this,t),this.requestUpdate(e,i,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??x}static _$Ei(){if(this.hasOwnProperty(_("elementProperties")))return;const e=p(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(_("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(_("properties"))){const e=this.properties,t=[...l(e),...h(e)];for(const r of t)this.createProperty(r,e[r])}const e=this[Symbol.metadata];if(null!==e){const t=litPropertyMetadata.get(e);if(void 0!==t)for(const[e,r]of t)this.elementProperties.set(e,r)}this._$Eh=new Map;for(const[e,t]of this.elementProperties){const r=this._$Eu(e,t);void 0!==r&&this._$Eh.set(r,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const e of r)t.unshift(a(e))}else void 0!==e&&t.push(a(e));return t}static _$Eu(e,t){const r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const r of t.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return((e,s)=>{if(r)e.adoptedStyleSheets=s.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(const r of s){const s=document.createElement("style"),n=t.litNonce;void 0!==n&&s.setAttribute("nonce",n),s.textContent=r.cssText,e.appendChild(s)}})(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$ET(e,t){const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(void 0!==s&&!0===r.reflect){const n=(void 0!==r.converter?.toAttribute?r.converter:f).toAttribute(t,r.type);this._$Em=e,null==n?this.removeAttribute(s):this.setAttribute(s,n),this._$Em=null}}_$AK(e,t){const r=this.constructor,s=r._$Eh.get(e);if(void 0!==s&&this._$Em!==s){const e=r.getPropertyOptions(s),n="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==e.converter?.fromAttribute?e.converter:f;this._$Em=s;const i=n.fromAttribute(t,e.type);this[s]=i??this._$Ej?.get(s)??i,this._$Em=null}}requestUpdate(e,t,r){if(void 0!==e){const s=this.constructor,n=this[e];if(r??=s.getPropertyOptions(e),!((r.hasChanged??b)(n,t)||r.useDefault&&r.reflect&&n===this._$Ej?.get(e)&&!this.hasAttribute(s._$Eu(e,r))))return;this.C(e,t,r)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(e,t,{useDefault:r,reflect:s,wrapped:n},i){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,i??t??this[e]),!0!==n||void 0!==i)||(this._$AL.has(e)||(this.hasUpdated||r||(t=void 0),this._$AL.set(e,t)),!0===s&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}const e=this.constructor.elementProperties;if(e.size>0)for(const[t,r]of e){const{wrapped:e}=r,s=this[t];!0!==e||this._$AL.has(t)||void 0===s||this.C(t,void 0,r,s)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach(e=>e.hostUpdate?.()),this.update(t)):this._$EM()}catch(t){throw e=!1,this._$EM(),t}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach(e=>e.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(e=>this._$ET(e,this[e])),this._$EM()}updated(e){}firstUpdated(e){}};y.elementStyles=[],y.shadowRootOptions={mode:"open"},y[_("elementProperties")]=new Map,y[_("finalized")]=new Map,m?.({ReactiveElement:y}),(u.reactiveElementVersions??=[]).push("2.1.1");const $=globalThis,w=$.trustedTypes,A=w?w.createPolicy("lit-html",{createHTML:e=>e}):void 0,E="$lit$",S=`lit$${Math.random().toFixed(9).slice(2)}$`,T="?"+S,N=`<${T}>`,k=document,D=()=>k.createComment(""),P=e=>null===e||"object"!=typeof e&&"function"!=typeof e,C=Array.isArray,O="[ \t\n\f\r]",R=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,I=/-->/g,M=/>/g,U=RegExp(`>|${O}(?:([^\\s"'>=/]+)(${O}*=${O}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),z=/'/g,H=/"/g,j=/^(?:script|style|textarea|title)$/i,L=(e=>(t,...r)=>({_$litType$:e,strings:t,values:r}))(1),B=Symbol.for("lit-noChange"),G=Symbol.for("lit-nothing"),F=new WeakMap,q=k.createTreeWalker(k,129);function V(e,t){if(!C(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==A?A.createHTML(t):t}const Y=(e,t)=>{const r=e.length-1,s=[];let n,i=2===t?"<svg>":3===t?"<math>":"",a=R;for(let t=0;t<r;t++){const r=e[t];let o,d,c=-1,l=0;for(;l<r.length&&(a.lastIndex=l,d=a.exec(r),null!==d);)l=a.lastIndex,a===R?"!--"===d[1]?a=I:void 0!==d[1]?a=M:void 0!==d[2]?(j.test(d[2])&&(n=RegExp("</"+d[2],"g")),a=U):void 0!==d[3]&&(a=U):a===U?">"===d[0]?(a=n??R,c=-1):void 0===d[1]?c=-2:(c=a.lastIndex-d[2].length,o=d[1],a=void 0===d[3]?U:'"'===d[3]?H:z):a===H||a===z?a=U:a===I||a===M?a=R:(a=U,n=void 0);const h=a===U&&e[t+1].startsWith("/>")?" ":"";i+=a===R?r+N:c>=0?(s.push(o),r.slice(0,c)+E+r.slice(c)+S+h):r+S+(-2===c?t:h)}return[V(e,i+(e[r]||"<?>")+(2===t?"</svg>":3===t?"</math>":"")),s]};class W{constructor({strings:e,_$litType$:t},r){let s;this.parts=[];let n=0,i=0;const a=e.length-1,o=this.parts,[d,c]=Y(e,t);if(this.el=W.createElement(d,r),q.currentNode=this.el.content,2===t||3===t){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(s=q.nextNode())&&o.length<a;){if(1===s.nodeType){if(s.hasAttributes())for(const e of s.getAttributeNames())if(e.endsWith(E)){const t=c[i++],r=s.getAttribute(e).split(S),a=/([.?@])?(.*)/.exec(t);o.push({type:1,index:n,name:a[2],strings:r,ctor:"."===a[1]?X:"?"===a[1]?ee:"@"===a[1]?te:Q}),s.removeAttribute(e)}else e.startsWith(S)&&(o.push({type:6,index:n}),s.removeAttribute(e));if(j.test(s.tagName)){const e=s.textContent.split(S),t=e.length-1;if(t>0){s.textContent=w?w.emptyScript:"";for(let r=0;r<t;r++)s.append(e[r],D()),q.nextNode(),o.push({type:2,index:++n});s.append(e[t],D())}}}else if(8===s.nodeType)if(s.data===T)o.push({type:2,index:n});else{let e=-1;for(;-1!==(e=s.data.indexOf(S,e+1));)o.push({type:7,index:n}),e+=S.length-1}n++}}static createElement(e,t){const r=k.createElement("template");return r.innerHTML=e,r}}function Z(e,t,r=e,s){if(t===B)return t;let n=void 0!==s?r._$Co?.[s]:r._$Cl;const i=P(t)?void 0:t._$litDirective$;return n?.constructor!==i&&(n?._$AO?.(!1),void 0===i?n=void 0:(n=new i(e),n._$AT(e,r,s)),void 0!==s?(r._$Co??=[])[s]=n:r._$Cl=n),void 0!==n&&(t=Z(e,n._$AS(e,t.values),n,s)),t}class K{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:r}=this._$AD,s=(e?.creationScope??k).importNode(t,!0);q.currentNode=s;let n=q.nextNode(),i=0,a=0,o=r[0];for(;void 0!==o;){if(i===o.index){let t;2===o.type?t=new J(n,n.nextSibling,this,e):1===o.type?t=new o.ctor(n,o.name,o.strings,this,e):6===o.type&&(t=new re(n,this,e)),this._$AV.push(t),o=r[++a]}i!==o?.index&&(n=q.nextNode(),i++)}return q.currentNode=k,s}p(e){let t=0;for(const r of this._$AV)void 0!==r&&(void 0!==r.strings?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}}class J{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,r,s){this.type=2,this._$AH=G,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e?.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Z(this,e,t),P(e)?e===G||null==e||""===e?(this._$AH!==G&&this._$AR(),this._$AH=G):e!==this._$AH&&e!==B&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):(e=>C(e)||"function"==typeof e?.[Symbol.iterator])(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==G&&P(this._$AH)?this._$AA.nextSibling.data=e:this.T(k.createTextNode(e)),this._$AH=e}$(e){const{values:t,_$litType$:r}=e,s="number"==typeof r?this._$AC(e):(void 0===r.el&&(r.el=W.createElement(V(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===s)this._$AH.p(t);else{const e=new K(s,this),r=e.u(this.options);e.p(t),this.T(r),this._$AH=e}}_$AC(e){let t=F.get(e.strings);return void 0===t&&F.set(e.strings,t=new W(e)),t}k(e){C(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let r,s=0;for(const n of e)s===t.length?t.push(r=new J(this.O(D()),this.O(D()),this,this.options)):r=t[s],r._$AI(n),s++;s<t.length&&(this._$AR(r&&r._$AB.nextSibling,s),t.length=s)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}}class Q{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,r,s,n){this.type=1,this._$AH=G,this._$AN=void 0,this.element=e,this.name=t,this._$AM=s,this.options=n,r.length>2||""!==r[0]||""!==r[1]?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=G}_$AI(e,t=this,r,s){const n=this.strings;let i=!1;if(void 0===n)e=Z(this,e,t,0),i=!P(e)||e!==this._$AH&&e!==B,i&&(this._$AH=e);else{const s=e;let a,o;for(e=n[0],a=0;a<n.length-1;a++)o=Z(this,s[r+a],t,a),o===B&&(o=this._$AH[a]),i||=!P(o)||o!==this._$AH[a],o===G?e=G:e!==G&&(e+=(o??"")+n[a+1]),this._$AH[a]=o}i&&!s&&this.j(e)}j(e){e===G?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class X extends Q{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===G?void 0:e}}class ee extends Q{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==G)}}class te extends Q{constructor(e,t,r,s,n){super(e,t,r,s,n),this.type=5}_$AI(e,t=this){if((e=Z(this,e,t,0)??G)===B)return;const r=this._$AH,s=e===G&&r!==G||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,n=e!==G&&(r===G||s);s&&this.element.removeEventListener(this.name,this,r),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class re{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Z(this,e)}}const se=$.litHtmlPolyfillSupport;se?.(W,J),($.litHtmlVersions??=[]).push("3.3.1");const ne=globalThis;let ie=class extends y{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,r)=>{const s=r?.renderBefore??t;let n=s._$litPart$;if(void 0===n){const e=r?.renderBefore??null;s._$litPart$=n=new J(t.insertBefore(D(),e),e,void 0,r??{})}return n._$AI(e),n})(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return B}};ie._$litElement$=!0,ie.finalized=!0,ne.litElementHydrateSupport?.({LitElement:ie});const ae=ne.litElementPolyfillSupport;ae?.({LitElement:ie}),(ne.litElementVersions??=[]).push("4.2.1");const oe={attribute:!0,type:String,converter:f,reflect:!1,hasChanged:b},de=(e=oe,t,r)=>{const{kind:s,metadata:n}=r;let i=globalThis.litPropertyMetadata.get(n);if(void 0===i&&globalThis.litPropertyMetadata.set(n,i=new Map),"setter"===s&&((e=Object.create(e)).wrapped=!0),i.set(r.name,e),"accessor"===s){const{name:s}=r;return{set(r){const n=t.get.call(this);t.set.call(this,r),this.requestUpdate(s,n,e)},init(t){return void 0!==t&&this.C(s,void 0,e,t),t}}}if("setter"===s){const{name:s}=r;return function(r){const n=this[s];t.call(this,r),this.requestUpdate(s,n,e)}}throw Error("Unsupported decorator location: "+s)};function ce(e){return(t,r)=>"object"==typeof r?de(e,t,r):((e,t,r)=>{const s=t.hasOwnProperty(r);return t.constructor.createProperty(r,e),s?Object.getOwnPropertyDescriptor(t,r):void 0})(e,t,r)}function le(e){return ce({...e,state:!0,attribute:!1})}function he(e,t,r,s){var n,i=arguments.length,a=i<3?t:s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,s);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}"function"==typeof SuppressedError&&SuppressedError;class pe extends ie{constructor(){super(...arguments),this.template="",this.variables={},this.value=null,this.unsubscribePromise=null}connectedCallback(){super.connectedCallback(),this.hass?this.unsubscribePromise||this.template&&(this.unsubscribePromise=this.hass.connection.subscribeMessage(e=>{this.value=e.result},{type:"render_template",template:this.template,variables:this.variables})):console.warn("hass object is not provided")}async disconnectedCallback(){if(super.disconnectedCallback(),this.unsubscribePromise)try{const e=await this.unsubscribePromise;return this.unsubscribePromise=null,e()}catch(e){if("not_found"!==e.code)throw e}}render(){var e;return null!==(e=this.value)&&void 0!==e?e:G}}var ue,ge;he([ce()],pe.prototype,"hass",void 0),he([ce()],pe.prototype,"template",void 0),he([ce()],pe.prototype,"variables",void 0),he([ce()],pe.prototype,"value",void 0),he([le()],pe.prototype,"unsubscribePromise",void 0),function(e){e.language="language",e.system="system",e.comma_decimal="comma_decimal",e.decimal_comma="decimal_comma",e.space_comma="space_comma",e.none="none"}(ue||(ue={})),function(e){e.language="language",e.system="system",e.am_pm="12",e.twenty_four="24"}(ge||(ge={}));var ve=((e,...t)=>{const r=1===e.length?e[0]:t.reduce((t,r,s)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+e[s+1],e[0]);return new i(r,e,s)})`:host{display:block;--trend-primary:var(--primary-color, #6366f1);--trend-secondary:var(--secondary-color, #8b5cf6);--trend-bg:var(--card-background-color, #ffffff);--trend-surface:var(--card-background-color, #f8fafc);--trend-text-primary:var(--primary-text-color, #64748b);--trend-text-secondary:var(--secondary-text-color, #0f172a);--trend-border-color:var(--divider-color, #e0e0e0);--trend-increase:#10b981;--trend-increase-light:#34d399;--trend-increase-secondary:#6ee7b7;--trend-increase-shadow:rgba(16, 185, 129, 0.15);--trend-decrease:#ef4444;--trend-decrease-light:#f87171;--trend-decrease-secondary:#fca5a5;--trend-decrease-shadow:rgba(239, 68, 68, 0.15);--trend-neutral:#94a3b8}.card-header{padding:12px 24px;border-bottom:1px solid var(--trend-border-color)}.header-content{display:flex;align-items:center;justify-content:space-between}.header-left{display:flex;align-items:center;gap:12px;flex:1}.icon-wrapper{width:40px;height:40px;background:linear-gradient(135deg,var(--trend-primary) 0,var(--trend-secondary) 100%);border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.icon-wrapper ha-icon{--mdc-icon-size:20px;color:#fff}.header-text{cursor:pointer;transition:opacity .2s}.header-text:hover{opacity:.8}.header-text h4{margin:0;font-size:20px;font-weight:700;color:var(--trend-text-secondary)}.settings-btn{width:40px;height:40px;border-radius:12px;background:var(--trend-surface);border:1px solid var(--trend-border-color);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;flex-shrink:0}.settings-btn:hover{transform:scale(1.05)}.settings-btn ha-icon{--mdc-icon-size:20px;color:var(--trend-text-primary);transition:transform .3s}.settings-btn.active ha-icon{transform:rotate(90deg)}.settings-panel{margin-top:16px}.settings-panel select{width:100%;background:var(--trend-surface);border:1px solid var(--trend-border-color);color:var(--trend-text-primary);border-radius:8px;padding:12px;font-size:14px;cursor:pointer;font-family:inherit;appearance:none;background-image:url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="%2364748b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>');background-repeat:no-repeat;background-position:right 12px center}.settings-panel select:focus{outline:0;border-color:var(--trend-border-color)}.settings-panel select option{background:var(--trend-bg);color:var(--trend-text-secondary);padding:8px}.card-content{padding:24px}.net-change{text-align:center;margin-bottom:12px;padding:20px;background:var(--trend-surface);border-radius:16px;border:1px solid var(--trend-border-color)}.net-change:hover{transform:translateY(-1px)}.net-change.up:hover{border-color:color-mix(in srgb,var(--trend-increase) 50%,transparent);background:linear-gradient(135deg,color-mix(in srgb,var(--trend-increase) 20%,transparent) 0,color-mix(in srgb,var(--trend-increase-secondary) 10%,transparent) 100%);box-shadow:0 4px 12px var(--trend-increase-light)}.net-change.down:hover{border-color:color-mix(in srgb,var(--trend-decrease) 50%,transparent);background:linear-gradient(135deg,color-mix(in srgb,var(--trend-decrease) 20%,transparent) 0,color-mix(in srgb,var(--trend-decrease-secondary) 10%,transparent) 100%);box-shadow:0 4px 12px var(--trend-decrease-light)}.trend-indicator{display:inline-flex;align-items:center;gap:8px;margin-bottom:12px}.trend-indicator ha-icon{--mdc-icon-size:24px}.main-value.up,.trend-indicator.up ha-icon,.trend-label.up{color:var(--trend-increase-light)}.main-value.down,.trend-indicator.down ha-icon,.trend-label.down{color:var(--trend-decrease-light)}.main-value.neutral,.trend-indicator.neutral ha-icon,.trend-label.neutral{color:var(--trend-neutral)}.trend-label{font-size:14px;font-weight:600;letter-spacing:.05em}.value-container{display:flex;align-items:baseline;justify-content:center;gap:8px;margin-bottom:4px}.main-value{font-size:56px;font-weight:700;line-height:1;font-feature-settings:"tnum";font-variant-numeric:tabular-nums}.unit{font-size:20px;color:var(--trend-text-primary);font-weight:500}.stats-grid{display:grid;grid-template-columns:1fr 1fr;grid-gap:16px;gap:16px;margin-bottom:12px}.stat-card{padding:16px;border-radius:16px;border:1px solid var(--trend-border-color);transition:all .2s}.stat-card:hover{transform:translateY(-2px)}.stat-card.increase{background:linear-gradient(135deg,color-mix(in srgb,var(--trend-increase-light) 20%,transparent) 0,transparent 100%);border-color:color-mix(in srgb,var(--trend-increase-light) 40%,transparent)}.stat-card.increase:hover{border-color:color-mix(in srgb,var(--trend-increase) 50%,transparent);background:linear-gradient(135deg,color-mix(in srgb,var(--trend-increase) 20%,transparent) 0,color-mix(in srgb,var(--trend-increase-secondary) 10%,transparent) 100%);box-shadow:0 4px 12px var(--trend-increase-light)}.stat-card.decrease{background:linear-gradient(135deg,color-mix(in srgb,var(--trend-decrease-light) 20%,transparent) 0,transparent 100%);border-color:color-mix(in srgb,var(--trend-decrease-light) 40%,transparent)}.stat-card.decrease:hover{border-color:color-mix(in srgb,var(--trend-decrease) 50%,transparent);background:linear-gradient(135deg,color-mix(in srgb,var(--trend-decrease) 20%,transparent) 0,color-mix(in srgb,var(--trend-decrease-secondary) 10%,transparent) 100%);box-shadow:0 4px 12px var(--trend-decrease-light)}.stat-header{display:flex;align-items:center;gap:8px;margin-bottom:12px}.stat-icon{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center}.stat-icon.increase{background:color-mix(in srgb,var(--trend-increase-light) 20%,transparent)}.stat-icon.decrease{background:color-mix(in srgb,var(--trend-decrease-light) 20%,transparent)}.stat-icon ha-icon{--mdc-icon-size:16px}.stat-icon.increase ha-icon,.stat-label.increase{color:var(--trend-increase-light)}.stat-icon.decrease ha-icon,.stat-label.decrease{color:var(--trend-decrease-light)}.stat-label{font-size:12px;font-weight:600;letter-spacing:.05em}.stat-value-container{display:flex;align-items:baseline;gap:6px;margin-bottom:8px}.stat-value{font-size:28px;font-weight:700;color:var(--trend-text-secondary);font-feature-settings:"tnum";font-variant-numeric:tabular-nums}.stat-unit{font-size:14px;color:var(--trend-text-primary)}.progress-bar{height:4px;background:var(--trend-border-color);border-radius:2px;overflow:hidden}.progress-fill{height:100%;border-radius:2px;transition:width .5s cubic-bezier(.4,0,.2,1)}.progress-fill.increase{background:linear-gradient(90deg,var(--trend-increase) 0,var(--trend-increase-secondary) 100%)}.progress-fill.decrease{background:linear-gradient(90deg,var(--trend-decrease) 0,var(--trend-decrease-secondary) 100%)}.preset-buttons{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px}.preset-btn{flex:1;min-width:80px;padding:10px 10px;border-radius:10px;border:1px solid var(--trend-border-color);font-size:13px;font-weight:500;cursor:pointer;transition:all .2s;font-family:inherit;white-space:nowrap;background:var(--trend-surface);color:var(--trend-text-primary)}.preset-btn:hover{transform:scale(1.05)}.preset-btn.active{background:linear-gradient(90deg,var(--trend-primary) 0,var(--trend-secondary) 100%);color:#fff;box-shadow:0 4px 6px -1px color-mix(in srgb,var(--trend-primary) 40%,transparent);transform:translateY(-1px);border-color:var(--trend-primary)}.preset-btn.active:hover{box-shadow:0 6px 8px -1px color-mix(in srgb,var(--trend-primary) 60%,transparent)}.mini-graph{background:var(--trend-surface);border-radius:16px;padding:16px;border:1px solid var(--trend-border-color);margin-top:16px}.graph-header{display:flex;align-items:center;justify-content:space-between}.graph-header span{font-size:12px;font-weight:600;color:var(--trend-text-primary);letter-spacing:.05em}.graph-header span.dates{font-size:11px}.graph-header ha-icon{--mdc-icon-size:16px;color:var(--trend-text-primary)}.graph-bars{position:relative;height:120px;display:flex;align-items:center;justify-content:space-between;gap:4px;padding:0}.graph-bars::before{content:'';position:absolute;top:50%;left:0;right:0;height:1px;background:var(--trend-border-color);z-index:0}.graph-bar-wrapper{position:relative;flex:1;height:100%;display:flex;align-items:center;justify-content:center}.graph-bar-wrapper:hover{opacity:.8}.graph-bar-wrapper:hover .bar-tooltip{opacity:1}.graph-bar{position:absolute;width:100%;border-radius:4px 4px 0 0;transition:all .3s cubic-bezier(.4,0,.2,1);z-index:1}.graph-bar.positive{bottom:50%;background:linear-gradient(to top,var(--trend-increase) 0,var(--trend-increase-light) 100%);box-shadow:0 -2px 12px var(--trend-increase-shadow)}.graph-bar.negative{top:50%;background:linear-gradient(to bottom,var(--trend-decrease) 0,var(--trend-decrease-light) 100%);box-shadow:0 2px 12px var(--trend-decrease-shadow);border-radius:0 0 4px 4px}.graph-bar.neutral{width:100%;height:2px;top:50%;transform:translateY(-50%);background:var(--trend-neutral);border-radius:2px}.bar-tooltip{position:absolute;font-size:10px;font-weight:600;color:var(--trend-text-secondary);opacity:0;transition:opacity .2s;white-space:nowrap;pointer-events:none}.graph-bar.positive .bar-tooltip{bottom:calc(100% + 4px)}.graph-bar.negative .bar-tooltip{top:calc(100% + 4px)}.graph-empty{text-align:center;padding:20px}.graph-empty p{margin:0;font-size:13px;color:var(--trend-text-primary)}.date-input-container{display:flex;flex-direction:row;justify-content:space-evenly;gap:12px;margin-bottom:12px;padding:16px;background:var(--trend-surface);border-radius:16px;border:1px solid var(--trend-border-color)}.date-input-wrapper{display:flex;flex-direction:column;width:48%;gap:8px}.date-input-wrapper label{display:block;font-size:12px;font-weight:600;color:var(--trend-text-primary);letter-spacing:.05em}.date-input-wrapper input[type=datetime-local]{background:var(--trend-surface);border:1px solid var(--trend-border-color);color:var(--trend-text-secondary);border-radius:8px;padding:10px 12px;font-size:14px;font-family:inherit;transition:all .2s}.date-input-wrapper input[type=datetime-local]:focus{outline:0;border-color:var(--trend-border-color);box-shadow:0 0 0 2px var(--trend-surface)}.date-input-wrapper input[type=datetime-local]::-webkit-calendar-picker-indicator{cursor:pointer}.message{text-align:center;padding:40px 20px;background:var(--trend-surface);border-radius:16px;border:1px solid var(--trend-border-color)}.message h3{margin:0;font-size:16px;font-weight:500;color:var(--trend-text-primary)}.message a{color:var(--trend-text-secondary);-webkit-text-decoration:none;text-decoration:none;transition:color .2s}.message a:hover{color:var(--trend-text-primary);-webkit-text-decoration:underline;text-decoration:underline}.message p{margin:8px 0 0;font-size:13px}.loading{display:flex;justify-content:center;align-items:center;padding:31px 0}.spinner{width:40px;height:40px;border:3px solid var(--trend-border-color);border-top-color:var(--trend-primary);border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}@media (max-width:600px){.date-input-container{flex-direction:column}.date-input-wrapper{width:unset}.card-content,.card-header{padding:16px}.header-text h4{font-size:18px}.main-value{font-size:48px}.unit{font-size:18px}.stats-grid{gap:12px}.stat-card{padding:12px}.stat-value{font-size:24px}.preset-buttons{padding:12px}.preset-btn{min-width:70px;padding:8px 12px;font-size:12px}.graph-bars{height:100px}}`;!function(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var s=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===r&&s.firstChild?s.insertBefore(n,s.firstChild):s.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}(ve);var me={name:"Trend-Analyse",name_entity:"{{entity_name}} Trend",no_data:"Keine Daten!",preset_1_hour:"1 Stunde",preset_12_hour:"12 Stunden",preset_24_hour:"24 Stunden",preset_7_day:"7 Tage",preset_30_day:"30 Tage",preset_dates:"Datum",beginning:"START",end:"ENDE",increase:"ANSTIEG",decrease:"RÜCKGANG",total_increase:"GESAMTZUNAHME",total_decrease:"GESAMTABNAHME",delta:"NETTO-ÄNDERUNG",graph_title:"TRENDGRAFIK"},_e={influxdb:"InfluxDB ist nicht verfügbar. Bitte überprüfen Sie die Installationshinweise",unknown:"Unbekannter Fehler: {{message}}"},fe={common:me,error:_e},be={name:"Trend Analysis",name_entity:"{{entity_name}} Trend",no_data:"No data!",preset_1_hour:"1 Hour",preset_12_hour:"12 Hours",preset_24_hour:"24 Hours",preset_7_day:"7 Day",preset_30_day:"30 Days",preset_dates:"Dates",beginning:"BEGINNING",end:"END",increase:"INCREASE",decrease:"DECREASE",total_increase:"TOTAL INCREASE",total_decrease:"TOTAL DECREASE",delta:"NET CHANGE",graph_title:"TREND GRAPH"},xe={influxdb:"InfluxDB is unavailable. Please review the installation notes",unknown:"Unknown error: {{message}}"},ye={common:be,error:xe},$e={name:"Analyse de tendance",name_entity:"Tendance {{entity_name}}",no_data:"Aucune donnée !",preset_1_hour:"1 Heure",preset_12_hour:"12 Heures",preset_24_hour:"24 Heures",preset_7_day:"7 Jours",preset_30_day:"30 Jours",preset_dates:"Dates",beginning:"DÉBUT",end:"FIN",increase:"AUGMENTATION",decrease:"DIMINUTION",total_increase:"AUGMENTATION TOTALE",total_decrease:"DIMINUTION TOTALE",delta:"VARIATION NETTE",graph_title:"GRAPHIQUE DE TENDANCE"},we={influxdb:"InfluxDB n'est pas disponible. Veuillez consulter les notes d'installation",unknown:"Erreur inconnue: {{message}}"},Ae={common:$e,error:we},Ee={name:"Analisi delle tendenze",name_entity:"Trend di {{entity_name}}",no_data:"Nessun dato!",preset_1_hour:"1 Ora",preset_12_hour:"12 Ore",preset_24_hour:"24 Ore",preset_7_day:"7 Giorni",preset_30_day:"30 Giorni",preset_dates:"Date",beginning:"INIZIO",end:"FINE",increase:"AUMENTO",decrease:"DIMINUZIONE",total_increase:"AUMENTO TOTALE",total_decrease:"DIMINUZIONE TOTALE",delta:"VARIAZIONE NETTA",graph_title:"GRAFICO DEL TREND"},Se={influxdb:"InfluxDB non è disponibile. Si prega di rivedere le note di installazione",unknown:"Errore sconosciuto: {{message}}"},Te={common:Ee,error:Se},Ne={name:"Trend Analizi",name_entity:"{{entity_name}} Değişimi",no_data:"Veri yok!",preset_1_hour:"1 Saat",preset_12_hour:"12 Saat",preset_24_hour:"24 Saat",preset_7_day:"7 Gün",preset_30_day:"30 Gün",preset_dates:"Tarih",beginning:"BAŞLANGIÇ",end:"BİTİŞ",increase:"ARTIŞ",decrease:"DÜŞÜŞ",total_increase:"TOPLAM ARTIŞ",total_decrease:"TOPLAM DÜŞÜŞ",delta:"NET DEĞİŞİM",graph_title:"TREND GRAFİĞİ"},ke={influxdb:"InfluxDB kullanılamıyor. Lütfen kurulum notlarını inceleyin",unknown:"Bilinmeyen Hata: {{message}}"},De={common:Ne,error:ke};const Pe="en",Ce={de:Object.freeze({__proto__:null,common:me,default:fe,error:_e}),en:Object.freeze({__proto__:null,common:be,default:ye,error:xe}),fr:Object.freeze({__proto__:null,common:$e,default:Ae,error:we}),it:Object.freeze({__proto__:null,common:Ee,default:Te,error:Se}),tr:Object.freeze({__proto__:null,common:Ne,default:De,error:ke})};class Oe{static initialize(e,t){var r;t&&Ce[t]?(this.currentLanguage=t,console.debug(`%cTREND-ANALYSIS-CARD %c Manual language set to '${t}'`,"padding: 2px 0px 2px 8px; font-weight: bold; background-color: gray; color: white;","")):(null===(r=null==e?void 0:e.locale)||void 0===r?void 0:r.language)?Ce[e.locale.language]?(this.currentLanguage=e.locale.language,console.debug(`%cTREND-ANALYSIS-CARD %c Hass language set to '${e.locale.language}'`,"padding: 2px 0px 2px 8px; font-weight: bold; background-color: gray; color: white;","")):(this.currentLanguage=Pe,console.debug(`%cTREND-ANALYSIS-CARD %c Hass language set to '${e.locale.language}', but no translation found. Falling back to '${Pe}'`,"padding: 2px 0px 2px 8px; font-weight: bold; background-color: gray; color: white;","")):(this.currentLanguage=Pe,console.debug(`%cTREND-ANALYSIS-CARD %c No language set, falling back to '${Pe}'`,"padding: 2px 0px 2px 8px; font-weight: bold; background-color: gray; color: white;",""))}static getTranslation(e,t){try{return e.split(".").reduce((e,t)=>null==e?void 0:e[t],Ce[t])}catch(e){return}}static localize(e,t={}){var r,s;const n=null!==(s=null!==(r=this.getTranslation(e,this.currentLanguage))&&void 0!==r?r:this.getTranslation(e,Pe))&&void 0!==s?s:void 0;return Object.entries(t).reduce((e,[t,r])=>null==e?void 0:e.replace(new RegExp(`\\{\\{${t}\\}\\}`,"g"),String(r)),n)}static t(e,t={}){return this.localize(e,t)}}Oe.currentLanguage=Pe,Oe.t.bind(Oe);const Re=Oe.t.bind(Oe);!function(e="ha-template"){customElements.get(e)||customElements.define(e,pe)}();console.info("%cTREND-ANALYSIS-CARD %c0.1.3","padding: 2px 0px 2px 8px; font-weight: bold; background-color: gray; color: white;","padding: 2px 8px 2px 0px; font-weight: bold; background-color: gray; color: turquoise;");let Ie=class extends ie{constructor(){super(...arguments),this._range={start:null,end:null},this._loading=!0,this._activePreset=24,this._showSettings=!1,this._showInfluxDBDocs=!1,this.presets=[{value:1,label:"common.preset_1_hour"},{value:12,label:"common.preset_12_hour"},{value:24,label:"common.preset_24_hour"},{value:168,label:"common.preset_7_day"},{value:720,label:"common.preset_30_day"}]}static get styles(){return ve}setConfig(e){this._config=e,this._activePreset=this._config.preset||24,Oe.initialize(this._hass,this._config.language)}set hass(e){this._hass=e}firstUpdated(){this._selectPreset(this._config.preset||24),Oe.initialize(this._hass,this._config.language)}async fetchHistory(e,t){const r=this._config.entity;if(!r)return[];const s=await this._hass.callApi("GET",`history/period/${e}?filter_entity_id=${r}&end_time=${t}`);return s.length?s[0].map(e=>({t:new Date(e.last_changed),v:parseFloat(e.state)})).filter(e=>!isNaN(e.v)):[]}async fetchInfluxdb(e,t){const r=this._config.entity;if(!r)return[];try{const s=await this._hass.callApi("GET",`influxdb_query_api/query/${r}?start=${e}&end=${t}`);return s&&Array.isArray(s)&&s.length?s.map(e=>({t:new Date(e.time),v:parseFloat(e.value)})).filter(e=>!isNaN(e.v)):[]}catch(e){throw console.error("Influxdb fetch failed:",e),new Error("error.influxdb")}}async calculate(){if(this._range.start&&this._range.end){this._loading=!0,this._result=void 0,this._showInfluxDBDocs=!1;try{const e=new Date(this._range.start).toISOString(),t=new Date(this._range.end).toISOString(),r="influxdb"===this._config.source?await this.fetchInfluxdb(e,t):await this.fetchHistory(e,t);let s=0,n=0;if(r.length>=2)for(let e=1;e<r.length;e++){const t=r[e].v-r[e-1].v;t>0?s+=t:n+=Math.abs(t)}if(0!=r.length){const e=r[r.length-1].v-r[0].v;this._result={start:r[0].t,end:r[r.length-1].t,first:r[0].v,last:r[r.length-1].v,increase:s,decrease:n,delta:e,trend:e>0?"up":e<0?"down":"neutral",graphData:this._prepareGraphData(r)}}else this._result=Re("common.no_data")}catch(e){"error.influxdb"===e.message?(this._showInfluxDBDocs=!0,this._result=Re(e.message)):e.message.startsWith("error.")?this._result=Re(e.message):(console.error("Trend analysis failed:",e),this._result=Re("error.unknown",{message:e.message}))}this._loading=!1}}_prepareGraphData(e){if(e.length<2)return[];const t=Math.max(1,Math.floor(e.length/30)),r=[];for(let s=0;s<e.length;s+=t)r.push(e[s]);r[r.length-1]!==e[e.length-1]&&r.push(e[e.length-1]);const s=[];for(let e=1;e<r.length;e++)s.push(r[e].v-r[e-1].v);return s}_showMoreInfo(){var e;(null===(e=this._config)||void 0===e?void 0:e.entity)&&function(e,t,r,s){s=s||{},r=null==r?{}:r;var n=new Event(t,{bubbles:void 0===s.bubbles||s.bubbles,cancelable:Boolean(s.cancelable),composed:void 0===s.composed||s.composed});n.detail=r,e.dispatchEvent(n)}(this,"hass-more-info",{entityId:this._config.entity})}_formatDateTimeLocal(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`}_formatDateHumanReadable(e){return e.toLocaleString()}_onStartDateChange(e){const t=e.target;t.value&&(this._range=Object.assign(Object.assign({},this._range),{start:new Date(t.value)}),this._activePreset=null,this.calculate().then())}_onEndDateChange(e){const t=e.target;t.value&&(this._range=Object.assign(Object.assign({},this._range),{end:new Date(t.value)}),this._activePreset=null,this.calculate().then())}_selectPreset(e){const t=new Date,r=new Date(t.getTime()-60*(e||this._activePreset||24)*60*1e3);this._range={start:r,end:t},this._activePreset=e,this.calculate().then()}_selectEntity(){var e,t;const r=null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.getElementById("entity-selector"))||void 0===t?void 0:t.value;this._config=Object.assign(Object.assign({},this._config),{entity:r}),this._showSettings=!1,this._selectPreset(this._config.preset||24)}_getNumericEntities(){return Object.keys(this._hass.states).filter(e=>{const t=this._hass.states[e],r=parseFloat(t.state);return!isNaN(r)&&"unknown"!==t.state&&"unavailable"!==t.state}).sort((e,t)=>{var r,s,n,i;const a=this._hass.states[e],o=this._hass.states[t],d=(null===(s=null===(r=null==a?void 0:a.attributes)||void 0===r?void 0:r.friendly_name)||void 0===s?void 0:s.trim())||e,c=(null===(i=null===(n=null==o?void 0:o.attributes)||void 0===n?void 0:n.friendly_name)||void 0===i?void 0:i.trim())||t;return d.localeCompare(c,void 0,{sensitivity:"base"})})}renderHeader(){var e,t;const r=this._hass.states[this._config.entity],s=null===(e=null==r?void 0:r.attributes)||void 0===e?void 0:e.friendly_name,n=(null===(t=this._config)||void 0===t?void 0:t.header)||(s?Re("common.name_entity",{entity_name:s}):Re("common.name"));return L`<div class="card-header"><div class="header-content"><div class="header-left"><div class="icon-wrapper"><ha-icon icon="mdi:chart-areaspline"></ha-icon></div><div class="header-text" @click="${()=>this._showMoreInfo()}"><h4>${n}</h4></div></div>${!1!==this._config.showSettings||void 0===this._config.entity?L`<button class="settings-btn ${this._showSettings?"active":""}" @click="${()=>this._showSettings=!this._showSettings}"><ha-icon icon="mdi:cog"></ha-icon></button>`:""}</div>${this._showSettings||!this._config.entity?L`<div class="settings-panel"><select id="entity-selector" @change="${this._selectEntity}"><option value="${null}">...</option>${this._getNumericEntities().map(e=>{const t=this._hass.states[e];return L`<option value="${e}"><ha-icon icon="${t.attributes.icon}"></ha-icon>${t.attributes.friendly_name||e}</option>`})}</select></div>`:""}</div>`}renderMessage(e){return L`<div class="message"><h3>${e} ${this._showInfluxDBDocs?L`<a href="https://github.com/Riscue/ha-influxdb-query-api" target="_blank"><p>https://github.com/Riscue/ha-influxdb-query-api</p></a>`:void 0}</h3></div>`}renderChanges(){var e;if(void 0===this._result)return G;if("string"==typeof this._result)return this.renderMessage(this._result);const t=this._hass.states[this._config.entity],r=(null===(e=null==t?void 0:t.attributes)||void 0===e?void 0:e.unit_of_measurement)||"",s=this._result,n=s.increase/(s.increase+s.decrease)*100,i=s.decrease/(s.increase+s.decrease)*100;return L`<div class="net-change ${s.trend}"><div class="trend-indicator ${s.trend}"><span class="trend-label">${Re("common.delta")} </span>${"up"===s.trend?L`<ha-icon icon="mdi:trending-up"></ha-icon><span class="trend-label ${s.trend}">${Re("common.increase")}</span>`:"down"===s.trend?L`<ha-icon icon="mdi:trending-down"></ha-icon><span class="trend-label ${s.trend}">${Re("common.decrease")}</span>`:G}</div><div class="value-container"><span class="main-value ${s.trend}">${s.delta.toFixed(2)}</span> <span class="unit">${r}</span></div></div><div class="stats-grid"><div class="stat-card increase"><div class="stat-header"><div class="stat-icon increase"><ha-icon icon="mdi:trending-up"></ha-icon></div><span class="stat-label increase">${Re("common.total_increase")}</span></div><div class="stat-value-container"><span class="stat-value">${s.increase.toFixed(2)}</span> <span class="stat-unit">${r}</span></div><div class="progress-bar"><div class="progress-fill increase" style="width:calc(${n.toFixed(0)}%)"></div></div></div><div class="stat-card decrease"><div class="stat-header"><div class="stat-icon decrease"><ha-icon icon="mdi:trending-down"></ha-icon></div><span class="stat-label decrease">${Re("common.total_decrease")}</span></div><div class="stat-value-container"><span class="stat-value">${s.decrease.toFixed(2)}</span> <span class="stat-unit">${r}</span></div><div class="progress-bar"><div class="progress-fill decrease" style="width:calc(${i.toFixed(0)}%)"></div></div></div></div>`}renderDatePickers(){return this._config.entity&&(!1===this._config.showPresets||!1!==this._config.showDatePickers&&null===this._activePreset)?L`<div class="date-input-container"><div class="date-input-wrapper"><label>${Re("common.beginning")}</label> <input type="datetime-local" .value="${this._range.start?this._formatDateTimeLocal(this._range.start):""}" @change="${this._onStartDateChange}"></div><div class="date-input-wrapper"><label>${Re("common.end")}</label> <input type="datetime-local" .value="${this._range.end?this._formatDateTimeLocal(this._range.end):""}" @change="${this._onEndDateChange}"></div></div>`:G}renderPresets(){return this._config.entity?!1===this._config.showPresets?G:L`<div class="preset-buttons">${this.presets.map(e=>L`<button class="preset-btn ${this._activePreset===e.value?"active":""}" @click="${()=>this._selectPreset(e.value)}">${Re(e.label)}</button>`)} ${!1!==this._config.showDatePickers?L`<button class="preset-btn ${null===this._activePreset?"active":""}" @click="${()=>this._selectPreset(null)}">${Re("common.preset_dates")}</button>`:void 0}</div>`:G}renderGraph(){var e;if(void 0===this._result||"string"==typeof this._result)return G;if(!1===this._config.showGraph)return G;const t=this._formatDateHumanReadable(this._result.start)||"",r=this._formatDateHumanReadable(this._result.end)||"",s=this._result.graphData||[];if(0===s.length)return L`<div class="mini-graph"><div class="graph-header"><span>${Re("common.graph_title")}</span><ha-icon icon="mdi:chart-line"></ha-icon></div><div class="graph-empty"><p>${Re("common.no_data")}</p></div></div>`;const n=this._hass.states[this._config.entity],i=(null===(e=null==n?void 0:n.attributes)||void 0===e?void 0:e.unit_of_measurement)||"",a=Math.max(...s.map(e=>Math.abs(e))),o=a>0?100/a:1;return L`<div class="mini-graph"><div class="graph-header"><div><span>${Re("common.graph_title")}</span> <span class="dates">(${t} - ${r})</span></div><ha-icon icon="mdi:chart-line"></ha-icon></div><div class="graph-bars">${s.map(e=>{const t=e*o,r=Math.abs(t);return 0===e?L`<div class="graph-bar-wrapper"><div class="graph-bar neutral"></div></div>`:e>0?L`<div class="graph-bar-wrapper"><div class="graph-bar positive" style="height:calc(${r/2}%)"><span class="bar-tooltip">+${e.toFixed(2)} ${i}</span></div></div>`:e<0?L`<div class="graph-bar-wrapper"><div class="graph-bar negative" style="height:calc(${r/2}%);bottom:calc(${50-r/2}%)"><span class="bar-tooltip">${e.toFixed(2)} ${i}</span></div></div>`:G})}</div></div>`}render(){return L`<ha-card>${this.renderHeader()}<div class="card-content">${this.renderPresets()} ${this.renderDatePickers()} ${this._loading?L`<div class="loading"><div class="spinner"></div></div>`:L`${this.renderChanges()} ${this.renderGraph()}`}</div></ha-card>`}};e([ce({attribute:!1})],Ie.prototype,"_hass",void 0),e([le()],Ie.prototype,"_config",void 0),e([le()],Ie.prototype,"_result",void 0),e([le()],Ie.prototype,"_range",void 0),e([le()],Ie.prototype,"_loading",void 0),e([le()],Ie.prototype,"_activePreset",void 0),e([le()],Ie.prototype,"_showSettings",void 0),e([le()],Ie.prototype,"_showInfluxDBDocs",void 0),Ie=e([(e=>(t,r)=>{void 0!==r?r.addInitializer(()=>{customElements.define(e,t)}):customElements.define(e,t)})("trend-analysis-card")],Ie),window.customCards=window.customCards||[],window.customCards.push({preview:!0,type:"trend-analysis-card",name:Re("common.name"),description:Re("common.description")});export{Ie as TrendAnalysisCard};
